Projeto 2:

LOAD CSV WITH HEADERS FROM "file:///MusicInfo.csv" As row
CREATE (a:Artista {nome: row.artist})
CREATE (g:Genero {nome: row.genre})
CREATE (m:Musica{id: toInteger(row.track_id),nome:row.name,ano:row.year})
CREATE (a)-[:FAZ]->(m)
CREATE (m)-[:PERTENCE]->(g) 
return a,m,g

LOAD CSV WITH HEADERS FROM "file:///MusicInfo.csv" As row
CREATE (a:Artista {nome: row.artist})
CREATE (g:Genero {nome: row.genre})
CREATE (m:Musica{id: toInteger(row.track_id),nome:row.name,ano:row.year})
CREATE (a)-[:FAZ]->(m)
CREATE (m)-[:PERTENCE]->(g) 
return a,m,g

CREATE CONSTRAINT unique_usuario IF NOT EXISTS FOR (u:Usuario) REQUIRE u.id IS UNIQUE;

CALL () {
  LOAD CSV WITH HEADERS FROM "file:///UserListeningHistory.csv" AS row
  WITH row WHERE row.user_id IS NOT NULL AND row.user_id <> ""
  MERGE (u:Usuario {id: row.user_id})
} IN TRANSACTIONS OF 100 ROWS
RETURN "Usu√°rios criados com sucesso"

CALL () {
  LOAD CSV WITH HEADERS FROM "file:///UserListeningHistory.csv" AS row
  WITH row WHERE row.user_id IS NOT NULL AND row.track_id IS NOT NULL AND row.user_id <> "" AND row.track_id <> ""
  MATCH (u:Usuario {id: row.user_id})
  MATCH (m:Musica {id: row.track_id})
  MERGE (u)-[:ESCUTOU {playcount: toInteger(row.playcount)}]->(m)
} IN TRANSACTIONS OF 100 ROWS
RETURN "Relacionamentos criados com sucesso"
